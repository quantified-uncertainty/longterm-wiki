# Session Checklist

> Generated by `/kickoff` at {TIMESTAMP}
> Branch: `{BRANCH}`
> Task: {TASK_DESCRIPTION}

---

## Before Implementation

- [ ] **Understand the task**: Read the issue/request carefully. List acceptance criteria.
- [ ] **Explore relevant code**: Read files that will be modified. Understand existing patterns.
- [ ] **Plan approach**: For non-trivial changes, think through the design before coding.

## During Implementation

- [ ] **Tests**: Write tests that cover happy paths AND edge cases. Tests should be designed to catch bugs, not just confirm the implementation works.
- [ ] **TypeScript**: New code is in TypeScript where possible. (Especially `crux/` code â€” new `.mjs` files should be `.ts` unless there's a build constraint.)
- [ ] **No hardcoded constants**: URLs, magic numbers, and thresholds are in config or shared constants, not inline.

## Code Quality Review

- [ ] **Correctness**: Traced logic step by step. No off-by-one, flipped conditions, wrong variable names, or broken call sites.
- [ ] **EntityLinks** *(if MDX changed)*: Every `<EntityLink id="X">` resolves to a real entity in `data/entities/*.yaml`. No path-style IDs.
- [ ] **Numeric ID stability** *(if entity YAML changed)*: No `numericId` values removed or changed.
- [ ] **MDX escaping** *(if MDX changed)*: No unescaped `$` or `<` in prose.
- [ ] **Content accuracy** *(if wiki content changed)*: No round-number statistics without citations, no claims contradicting data on the same page.
- [ ] **Shell injection**: Any `curl -d` with variable interpolation uses `jq -n --arg`, not raw string interpolation.
- [ ] **Security**: No hardcoded secrets, no unsanitized user input in commands/queries/HTML, nothing that should be in `.gitignore`.

## Codebase Integration

- [ ] **No dead code**: Changes didn't make existing code redundant. Grepped for replaced functions/types/constants.
- [ ] **No DRY violations**: New logic doesn't duplicate existing utilities in `crux/lib/`, `app/src/lib/`, or shared components.
- [ ] **Full integration**: New types have consumers, new data fields have UI, new config has docs, new CLI commands are registered, new pages are in sidebar nav.
- [ ] **No regressions**: Grepped for patterns related to changes and verified nothing is stale or inconsistent.
- [ ] **Refactoring**: If touched code has clear structural problems, fixed them rather than leaving tech debt.

## Environment and Deployment

- [ ] **Multi-environment**: Works in Claude Code web sandboxes (limited network, no `gh` CLI) and local dev.
- [ ] **Deployment requirements**: Any manual steps needed after merge are documented in PR description and GitHub issue.

## Self-Audit

- [ ] **Re-ran commands**: Every command I claimed to run has been re-run and the output matches my claims.
- [ ] **Verified claims**: Every file I said I modified has been re-read and confirmed correct.
- [ ] **No fabricated outputs**: Test counts, line counts, and error counts match actual output.

## Gate Check

- [ ] **`pnpm crux validate gate --fix` passes**: Record exact test count and checks passed here: ___
- [ ] **crux TypeScript** *(if crux/ changed)*: `cd crux && npx tsc --noEmit` passes.

## PR Description

- [ ] **Summary**: 2-5 bullet points explaining what changed and why.
- [ ] **Key changes**: 1-line explanation per significant file/module.
- [ ] **New pages/dashboards**: Routes listed (e.g., `/internal/facts`, `/wiki/E814`).
- [ ] **Deployment notes**: Documented if applicable.
- [ ] **GitHub issues**: Closes/references listed. New issues filed listed.
- [ ] **Test plan**: Verified checklist with concrete, verifiable items. All items checked. Wrong/inapplicable items deleted, not left unchecked.

## Issue Tracking

- [ ] **Originating issue updated**: `pnpm crux issues done <N> --pr=<URL>` (if working on an issue).
- [ ] **Follow-up issues filed**: Out-of-scope work tracked as GitHub issues.

## Session Log

- [ ] **Session log created**: `.claude/sessions/YYYY-MM-DD_<branch-suffix>.md` following the format in `.claude/rules/session-logging.md`.

## Ship

- [ ] **Pushed and CI green**: `/push-and-ensure-green` completed successfully.
