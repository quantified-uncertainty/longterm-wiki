date: 2026-02-19
branch: claude/review-checklist-system-S1EpS
title: Add check/verify commands to reduce checklist friction
model: opus-4-6
duration: ~1h
pages: []
summary: "Reviewed the checklist system (PR #282) and analyzed 15 post-checklist PRs — none used the checklist. Root cause: too much friction (each checkbox requires 2-3 tool calls to edit markdown). Added `check` and `verify` subcommands to `agent-checklist` CLI. `check` marks items by ID in one command. `verify` auto-runs verifiable items (gate, escaping, TypeScript) and marks them done. Also numbered checklist items with explicit IDs and tagged auto-verifiable items."
issues:
  - "`--na` flag consumed the next positional arg as its value due to CLI parser behavior. Fixed with rescue logic."
  - Pre-existing TypeScript errors throughout crux/ (100+) — none from our changes.
learnings:
  - Checklist fatigue is a human problem, not an AI problem. The real blocker for AI agents is the tool-call cost of editing markdown checkboxes (2-3 calls per item x 28 items = ~60-80 tool calls).
  - The `check` command reduces this to 1 call per batch of items.
  - 7 items in the catalog now have `verifyCommand` for programmatic verification.
recommendations:
  - The CLI arg parser (`crux/lib/cli.ts` `parseCliArgs`) treats `--flag nextArg` as `flag=nextArg` when nextArg doesn't start with `--`. This is a footgun for boolean flags. Consider adding a `booleanFlags` parameter to `parseCliArgs` so flags like `--na`, `--ci`, `--fix` are always treated as booleans.
  - The `verify` command runs verifyCommands sequentially. For items like `gate-passes` (which takes ~50s), this is fine since it includes tests. But if more verifyCommands are added, consider parallelizing independent checks.
  - Old-format checklists (pre-numbered) have ID derivation mismatches for some items (e.g., `mdx-escaping-correct` vs catalog ID `mdx-escaping`). The `verify` command won't auto-check these. Not worth fixing since old checklists are rare, but worth knowing.
  - Consider adding a `crux agent-checklist check-all` shortcut that marks all remaining items as checked — useful for quick-fix sessions where the full checklist is overkill but you still want to signal completion.
  - The `/agent-session-start` and `/agent-session-ready-PR` slash commands should be updated to use `check` and `verify` instead of telling the agent to manually edit the markdown file.
