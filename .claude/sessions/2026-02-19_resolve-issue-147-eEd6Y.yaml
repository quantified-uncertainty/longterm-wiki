date: 2026-02-19
branch: claude/resolve-issue-147-eEd6Y
title: Add entity rename command with word-boundary ID matching
model: sonnet-4
duration: ~30min
pages: []
summary: >
  Implemented `pnpm crux entity rename <old-id> <new-id>` command that uses
  word-boundary regex (\b) to safely rename entity IDs without partial matches
  (e.g. E6 no longer matches E64). Added 20 unit tests covering the core regex
  behaviour and renameInContent function.
issues:
  - None
learnings:
  - JavaScript \b word boundaries work correctly for numeric IDs (E6 vs E64) because
    digits are word characters. For hyphenated slugs, \b sits at each hyphen
    boundary, so ai-control matches within ai-control-research â€” acceptable in
    practice since slug IDs are always quoted in EntityLink attributes.
  - Module-level CLI entry code must be guarded with
    `process.argv[1] === fileURLToPath(import.meta.url)` to avoid calling
    process.exit() when the file is imported by tests.
  - The vitest.config.ts include list must be updated when adding a new test
    directory (entity/**/*.test.ts was missing).
