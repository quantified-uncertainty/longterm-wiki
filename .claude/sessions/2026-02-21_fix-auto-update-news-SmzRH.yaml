date: "2026-02-21"
branch: claude/fix-auto-update-news-SmzRH
title: "fix(wiki-server): inArray for dashboard query, Zod validation for runs param, tests for auto-update-news"
issues: ["513", "514", "515"]
pr: https://github.com/quantified-uncertainty/longterm-wiki/pull/527
model: sonnet-4-6
duration: ~60min
cost: ~$2

summary: >
  Resolved three issues in apps/wiki-server/src/routes/auto-update-news.ts.
  (#513) Replaced sql.raw(ARRAY[...]) with Drizzle's inArray() in /dashboard,
  eliminating raw SQL construction. (#515) Added DashboardQuery Zod schema for
  the runs query param â€” previously parseInt("abc") NaN was silently forwarded
  to the DB; now returns 400. (#514) Added auto-update-news.test.ts with 28
  tests covering all 5 endpoints. Also removed unused sql and gte imports.

checks:
  initialized: true
  type: infrastructure
  initiated_at: "2026-02-21T19:31:38.560Z"
  total: 32
  completed: 22
  na: 3
  skipped: 7
  items:
    - read-issue
    - explore-code
    - plan-approach
    - tests-written
    - no-hardcoded
    - typescript-used
    - correctness
    - paranoid-review
    - shell-injection
    - security
    - no-dead-code
    - no-dry-violations
    - full-integration
    - no-regressions
    - backward-compatible
    - ci-coverage
    - tooling-gaps-found
    - self-audit-commands
    - self-audit-files
    - self-audit-no-fabrication
    - gate-passes
    - crux-typescript

pages: []
