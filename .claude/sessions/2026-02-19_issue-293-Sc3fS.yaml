date: 2026-02-19
branch: claude/issue-293-Sc3fS
title: "Discord bot: refactor cost tracking into pricing.ts"
model: sonnet-4
duration: ~20min
pages: []
summary: >
  Extracted the PRICING table from logger.ts into a new pricing.ts module. Fixed the stale
  claude-sonnet-4-20250514 model ID to claude-sonnet-4-6, added cache-read token pricing
  (~10% of input), added a console.warn for unknown models, and updated calculateCost to
  accept an optional cacheReadTokens parameter. Extended tests to cover cache-read pricing
  and the unknown-model warning.
issues: []
learnings:
  - The existing test for "unknown model" was silent about warnings; now it explicitly asserts the console.warn call.
  - claude-sonnet-4-6 is the correct model ID for Sonnet 4 per the system prompt.
