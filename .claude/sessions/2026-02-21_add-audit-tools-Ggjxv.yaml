date: "2026-02-21"
branch: claude/add-audit-tools-Ggjxv
title: "fix: audit tools, test mocks, unused imports, inArray (#529 #530 #533 #538)"
summary: >
  Four targeted single-file cleanup fixes. #529: added crux-audit-source-replace
  and crux-audit-pass2 to VALID_TOOLS/EditTool so audit edit logs are no longer
  silently dropped. #530: fixed sync-sessions test mocks returning { inserted }
  instead of { upserted }, matching batchSync's responseCountKey. #533: removed
  unused imports (gte, firstOrThrow, sql, readEditLog, CommandOptions), fixed
  missing EOF newline in app.ts, updated stale data/edit-logs/ references in
  crux/README.md. #538: replaced sql.raw(ARRAY[...]) with inArray() in the
  auto-update-news dashboard handler.
model: claude-sonnet-4-6
duration: ~20min
cost: ~$2
pr: https://github.com/quantified-uncertainty/longterm-wiki/pull/542
pages: []
issues:
  - 529
  - 530
  - 533
  - 538
checks:
  initialized: true
  type: bugfix
  initiated_at: "2026-02-21T21:27:05.028Z"
  total: 30
  completed: 18
  na: 7
  skipped: 5
  items:
    - read-issue
    - explore-code
    - plan-approach
    - root-cause
    - no-hardcoded
    - fix-minimal
    - correctness
    - security
    - no-dead-code
    - no-dry-violations
    - full-integration
    - no-regressions
    - self-audit-commands
    - self-audit-files
    - self-audit-no-fabrication
    - gate-passes
    - pr-description
    - issue-tracking
