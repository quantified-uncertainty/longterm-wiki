date: 2026-02-21
branch: claude/issue-434-6BQc7
title: "Add resources + resource_citations tables to wiki-server"
model: claude-opus-4-6
pr: https://github.com/quantified-uncertainty/longterm-wiki/pull/443
issue: 434
pages: []
duration: ~30min
cost: ~$5
checks:
  initialized: true
  type: infrastructure
  initiated_at: "2026-02-21T04:21:07.836Z"
  total: 32
  completed: 25
  na: 5
  skipped: 2
  items:
    - read-issue
    - explore-code
    - plan-approach
    - tests-written
    - no-hardcoded
    - typescript-used
    - correctness
    - paranoid-review
    - shell-injection
    - security
    - no-dead-code
    - no-dry-violations
    - full-integration
    - no-regressions
    - backward-compatible
    - multi-environment
    - ci-coverage
    - self-audit-commands
    - self-audit-files
    - self-audit-no-fabrication
    - gate-passes
    - pr-description
    - issue-tracking
    - no-merge-conflicts
    - check-recent-merges
summary: |
  Added PostgreSQL resources + resource_citations tables to wiki-server
  as step 5 of 8 in the server database refactoring effort.

  New tables mirror the YAML data in data/resources/*.yaml (~3,160 resources).
  YAML stays authoritative; DB serves as an indexed read mirror.

  Added full REST API (8 endpoints): upsert, batch upsert, lookup by URL,
  get by ID, search, stats, by-page, paginated listing.

  Paranoid review found and fixed: batch transaction not using tx client,
  unused VALID_TYPES constant, variable shadowing, ILIKE wildcard injection.

  Added seed-resources.ts for importing YAML data into PostgreSQL.
  20 unit tests covering all endpoints, all 968 workspace tests pass.
