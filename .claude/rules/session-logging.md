- **Session logs are stored in PostgreSQL** via the wiki-server API. They are not committed to git. Write a `.yaml` file and call `pnpm crux wiki-server sync-session <file>` to push it to the DB (see `agent-session-ready-PR` Step 5 for the exact workflow).
- **Auto-improve sessions** (`pnpm crux content improve --apply`) are written to the DB automatically — no manual step needed for those.
- **Always include the `checks:` field** — run `pnpm crux agent-checklist snapshot` immediately before creating the session log and paste the output verbatim. This captures the checklist state at ship time as a machine-readable audit trail. The `initiated_at` timestamp reveals whether the checklist was initialized at session start (good) or created at the last minute (red flag). If no checklist was used, the command outputs `checks: {initialized: false}` — include that too, honestly. A missing `checks:` field generates a validation warning.
- **Always fill in `issues`, `learnings`, `recommendations`** as YAML arrays (not prose). These are stored as JSONB in the DB and are the main value of the session log — they capture institutional knowledge about what went wrong, what was learned, and what should be done next. Do not leave them empty.
- **Format is machine-parsed**: The `date`, `branch`, `title`, `pages`, `pr`, `model`, `duration`, and `cost` fields are parsed by the wiki-server sessions API to build the `/internal/page-changes` dashboard. Validated by Zod schema in the server's `api-types.ts`.
- **Local YAML files** (`.claude/sessions/*.yaml`) are gitignored. They may still be written locally as a cache but are NOT committed. The DB is the source of truth for session history.
