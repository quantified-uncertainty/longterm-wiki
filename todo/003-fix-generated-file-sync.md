# Fix generated file sync: id-registry, pathRegistry, schema.ts

**Priority:** High
**Effort:** ~45–60 min
**Risk:** Medium (touches build pipeline)

## Problem

Several files that should be build-time generated artifacts are committed to git and/or duplicated in multiple locations. This leads to silent drift.

### A. `id-registry.json` committed in two places, out of sync

| File | Lines | Entities |
|------|-------|----------|
| `/data/id-registry.json` | 637 | 633 entities (source of truth) |
| `/app/src/data/id-registry.json` | 494 | ~491 entities (stale copy) |

The app copy is **142 entities behind** the source. This could cause build-time ID assignment inconsistencies.

**Fix:**
1. Ensure `build-data.mjs` copies/generates `app/src/data/id-registry.json` from `/data/id-registry.json` during the build
2. Add `app/src/data/id-registry.json` to `app/.gitignore`
3. Remove the stale copy from git tracking: `git rm --cached app/src/data/id-registry.json`

### B. `pathRegistry.json` committed when it should be generated

`app/src/data/pathRegistry.json` (591 lines) is a build artifact that maps slugs to URL paths. It's generated by `build-data.mjs` but committed to git.

**Fix:**
1. Add `app/src/data/pathRegistry.json` to `app/.gitignore`
2. Remove from git tracking: `git rm --cached app/src/data/pathRegistry.json`
3. Ensure `build-data.mjs` generates it reliably

### C. Duplicate `schema.ts` files

Two nearly-identical 819-line files:
- `/data/schema.ts` — source of truth, used by tooling
- `/app/src/data/schema.ts` — copy used by app

They differ only in path comments (`src/data/` vs `data/`). No sync mechanism exists.

**Fix (choose one):**
1. **Preferred:** Have `build-data.mjs` copy `/data/schema.ts` → `/app/src/data/schema.ts` at build time (with comment adjustment) and gitignore the app copy
2. **Alternative:** Move the canonical schema to a shared location and have both tooling and app import from there
3. **Minimum:** Add a CI check that diffs the two files and fails if they diverge (beyond the known comment difference)

## Verification

1. `pnpm build` succeeds from a clean state (no pre-existing generated files)
2. `git status` shows no untracked generated files in `app/src/data/`
3. Entity IDs are consistent between source and build output
